<!doctype html><html class=no-js lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta property="og:title" content="Wild Rydes Asynchronous Messaging Workshop"><meta property="og:type" content="website"><meta property="og:url" content><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=generator content="Hugo 0.83.1"><meta name=description content="Wild Rydes Asynchronous Messaging Workshop"><meta name=author content="Jane Architect"><link rel="shortcut icon" href=https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico type=image/ico><link rel=icon href=https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico type=image/ico><title>Console :: Wild Rydes Asynchronous Messaging Workshop</title><link href=../../css/nucleus.css rel=stylesheet><link href=../../css/fontawesome-all.min.css rel=stylesheet><link href=../../css/hybrid.css rel=stylesheet><link href=../../css/featherlight.min.css rel=stylesheet><link href=../../css/perfect-scrollbar.min.css rel=stylesheet><link href=../../css/auto-complete.css rel=stylesheet><link href=../../css/atom-one-dark-reasonable.css rel=stylesheet><link href=../../css/theme.css rel=stylesheet><link href=../../css/hugo-theme.css rel=stylesheet><link href=../../css/theme-aws.css rel=stylesheet><link href=../../css/jquery-ui.min.css rel=stylesheet><script src=../../js/jquery-3.5.1.min.js></script><script src=../../js/jquery-ui-1.12.1.min.js></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style></head><body data-url=../../topic-queue-chaining-and-load-balancer/create-customer-notification-service-subscription/create-customer-notification-service-subscription-console.html><nav id=sidebar><div id=header-wrapper><div id=header><div><a href=../../ title="Go home"><img style=vertical-align:middle src=../../images/logo.png height=70px></a></div></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../../js/lunr.min.js></script><script type=text/javascript src=../../js/auto-complete.js></script><script type=text/javascript>var baseurl="https://marcinbelczewski.github.io/asynchronous-messaging-workshop/"</script><script type=text/javascript src=../../js/search.js></script></div><div class=highlightable><ul class=topics><li data-nav-id=/prerequisites.html title="Workshop Prerequisites" class=dd-item><a href=../../prerequisites.html>Workshop Prerequisites</a><ul><li data-nav-id=/prerequisites/prerequisites-1.html title="Account Setup" class=dd-item><a href=../../prerequisites/prerequisites-1.html>Account Setup</a><ul></ul></li><li data-nav-id=/prerequisites/prerequisites-2/prerequisites-2.html title="Configure AWS Cloud9" class=dd-item><a href=../../prerequisites/prerequisites-2/prerequisites-2.html>Configure AWS Cloud9</a></li></ul></li><li data-nav-id=/choose-your-own-advanture.html title="Choose Your Own Adventure" class=dd-item><a href=../../choose-your-own-advanture.html>Choose Your Own Adventure</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer.html title="Topic-Queue Chaining & Load Balancing" class="dd-item
parent"><a href=../../topic-queue-chaining-and-load-balancer.html>Lab-2: Topic-Queue Chaining & Load Balancing</a><ul><li data-nav-id=/topic-queue-chaining-and-load-balancer/bootstrap-initial-state/bootstrap-initial-state.html title="Bootstrap the Initial State" class=dd-item><a href=../../topic-queue-chaining-and-load-balancer/bootstrap-initial-state/bootstrap-initial-state.html>1 Bootstrap the Initial State</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer/create-sns-topic/create-sns-topic.html title="Create the Amazon SNS topic" class=dd-item><a href=../../topic-queue-chaining-and-load-balancer/create-sns-topic/create-sns-topic.html>2 Create the Amazon SNS topic</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer/create-customer-notification-service-subscription/create-customer-notification-service-subscription.html title="Create Customer Notification Service Subscription" class=dd-item><a href=../../topic-queue-chaining-and-load-balancer/create-customer-notification-service-subscription/create-customer-notification-service-subscription.html>3 Create Customer Notification Service Subscription</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer/create-customer-accounting-service-subscription/create-customer-accounting-service-subscription.html title="Create Customer Accounting Service Subscription" class=dd-item><a href=../../topic-queue-chaining-and-load-balancer/create-customer-accounting-service-subscription/create-customer-accounting-service-subscription.html>4 Create Customer Accounting Service Subscription</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer/create-extraordinary-rides-service-subscription/create-extraordinary-rides-service-subscription.html title="Create Extraordinary Rides Service Subscription" class=dd-item><a href=../../topic-queue-chaining-and-load-balancer/create-extraordinary-rides-service-subscription/create-extraordinary-rides-service-subscription.html>5 Create Extraordinary Rides Service Subscription</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer/update-unicorn-management-service/update-unicorn-management-service.html title="Update Unicorn Management Service" class=dd-item><a href=../../topic-queue-chaining-and-load-balancer/update-unicorn-management-service/update-unicorn-management-service.html>6 Update Unicorn Management Service</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer/test-topic-queue-chaining-and-load-balancer/test-topic-queue-chaining-and-load-balancing.html title="Test Topic-Queue Chaining & Load Balancing" class=dd-item><a href=../../topic-queue-chaining-and-load-balancer/test-topic-queue-chaining-and-load-balancer/test-topic-queue-chaining-and-load-balancing.html>7 Test Topic-Queue Chaining & Load Balancing</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer/clean-up/clean-up.html title="Clean up" class=dd-item><a href=../../topic-queue-chaining-and-load-balancer/clean-up/clean-up.html>8 Clean up</a></li></ul></li><li data-nav-id=/cleanups.html title="Clean up" class=dd-item><a href=../../cleanups.html>Clean up</a></li><li data-nav-id=/resources.html title=Resources class=dd-item><a href=../../resources.html>Resources</a></li></ul><section id=shortcuts><h3></h3><ul><li><a class=padding href=https://github.com/marcinbelczewski/asynchronous-messaging-workshop/><i class="fab fa-github"></i> Github repo</a></li></ul></section><section id=footer><left><h5 class=copyright>&copy; 2019 Amazon Web Services, Inc. or its Affiliates. All rights reserved.<h5></left></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://code.amazon.com/packages/AwsSaDeMsgPtnMcrSrv/trees/mainline/--/workshop/content/topic-queue-chaining-and-load-balancer/create-customer-notification-service-subscription/create-customer-notification-service-subscription-console.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fa fa-bars"></i></a></span>
<span class=links><a href=https://marcinbelczewski.github.io/asynchronous-messaging-workshop/>Decoupled Microservices</a> > <a href=https://marcinbelczewski.github.io/asynchronous-messaging-workshop/topic-queue-chaining-and-load-balancer.html>Topic-Queue Chaining & Load Balancing</a> > Console</span></div></div></div><div id=body-inner><h1>Console</h1><h4 id=1-create-a-new-amazon-sqs-queue>1. Create a new Amazon SQS queue</h4><p>In your <strong><a href=https://console.aws.amazon.com/sqs/home?>Amazon SQS console</a></strong>, select <strong>Create New Queue</strong> in top left corner or click <strong>Get Started Now</strong> in the center of the page, if it&rsquo;s your first queue in this region.</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this),$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right'})})"><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Detailed description</span></div><div class=expand-content style=display:none><p><img src=step-1-console.png alt="Step 1"></p></div></div><p>Enter <code>%INITIALS%-CustomerNotificationServiceQueue</code> as <strong>Queue Name</strong>, make sure <strong>Standard Queue</strong> is highlighted and the queue name is prefixed with your initials. Click <strong>Create Queue</strong>.</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this),$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right'})})"><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Detailed description</span></div><div class=expand-content style=display:none><p><img src=step-2-console.png alt="Step 2"></p></div></div><h4 id=2-create-a-new-subscription>2. Create a new subscription</h4><p>After creating <code>%INITIALS%-CustomerNotificationServiceQueue</code>, click the <strong>Subscribe to Amazon SNS topic</strong> button.</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this),$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right'})})"><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Detailed description</span></div><div class=expand-content style=display:none><p><img src=step-3-console.png alt="Step 3"></p></div></div><p>From the drop down, select the <code>%INITIALS%-RideCompletionTopic</code> ARN and click <strong>Save</strong>.</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this),$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right'})})"><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Detailed description</span></div><div class=expand-content style=display:none><p><img src=step-4-console.png alt="Step 4"></p></div></div><div class="notices tip"><p>You may wondering why we don&rsquo;t create the subscription from the Amazon SNS console as shown below. If we create a subscription from Amazon SNS to Amazon SQS, Amazon SNS will send a confirmation message first to Amazon SQS. As long as this subscription is not confirmed, Amazon SNS will not start sending messages to Amazon SQS.
By initiating the subscription from the subscriber side, this is not necessary.
<img src=tip.png alt=Tip></p></div><h4 id=3-validate-the-subscription-confirmation>3. Validate the subscription confirmation</h4><p>Browse to your <strong><a href=https://console.aws.amazon.com/sns/v3/home?#/topics>Amazon SNS console</a></strong> to list your existing topics. Select the <code>%INITIALS%-RideCompletionTopic</code> and verify, the subscription has the status <strong>Confirmed</strong>.</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this),$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right'})})"><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Detailed description</span></div><div class=expand-content style=display:none><p><img src=step-5-console.png alt="Step 5"></p></div></div><h4 id=4-grant-permissions-to-our-function-to-access-the-amazon-sqs-queue>4. Grant permissions to our function to access the Amazon SQS queue</h4><p>In your <strong><a href=https://console.aws.amazon.com/iam>Amazon IAM console</a></strong>, select <strong>Roles</strong> in the left navigation. Use the filter text box to find the role with the name <code>%INITIALS%-wild-rydes-async-msg-2-CustomerNotificationService-...</code> (assuming your have chosen <code>%INITIALS%-wild-rydes-async-msg-2</code> as your stack name).</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this),$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right'})})"><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Detailed description</span></div><div class=expand-content style=display:none><p><img src=step-6-console.png alt="Step 6"></p></div></div><p>Click on the role name and click <strong>Add inline policy</strong> to attache another one.</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this),$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right'})})"><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Detailed description</span></div><div class=expand-content style=display:none><p><img src=step-7-console.png alt="Step 7"></p></div></div><p>Select the <strong>JSON</strong> tab and passed the following policy statement into it, after you have substitute &#171;&mldr;&#187; and %INITIALS% with the correct values. It will add the permission to your Lambda function to access the Amazon SQS queue:</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this),$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right'})})"><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>policy</span></div><div class=expand-content style=display:none><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;Statement&#34;</span>: <span style=color:#f92672>[</span>
        <span style=color:#f92672>{</span>
            <span style=color:#e6db74>&#34;Effect&#34;</span>: <span style=color:#e6db74>&#34;Allow&#34;</span>,
            <span style=color:#e6db74>&#34;Action&#34;</span>: <span style=color:#f92672>[</span>
                <span style=color:#e6db74>&#34;sqs:ChangeMessageVisibility&#34;</span>,
                <span style=color:#e6db74>&#34;sqs:ChangeMessageVisibilityBatch&#34;</span>,
                <span style=color:#e6db74>&#34;sqs:DeleteMessage&#34;</span>,
                <span style=color:#e6db74>&#34;sqs:DeleteMessageBatch&#34;</span>,
                <span style=color:#e6db74>&#34;sqs:GetQueueAttributes&#34;</span>,
                <span style=color:#e6db74>&#34;sqs:ReceiveMessage&#34;</span>
            <span style=color:#f92672>]</span>,
            <span style=color:#e6db74>&#34;Resource&#34;</span>: <span style=color:#e6db74>&#34;arn:aws:sqs:&lt;&lt;AWS REGION&gt;&gt;:&lt;&lt;AWS ACCOUNT ID&gt;&gt;:%INITIALS%-CustomerNotificationServiceQueue&#34;</span>
        <span style=color:#f92672>}</span>
    <span style=color:#f92672>]</span>
<span style=color:#f92672>}</span>
</code></pre></div></div></div><div class="notices tip"><p>Make sure you provide the AWS ACCOUNT ID in the form of XXXXXXXXXXXX and not XXXX-XXXX-XXXX!</p></div><p>Click <strong>Review policy</strong> and enter the <strong>Name</strong> <code>CustomerNotificationServiceRolePolicy0</code>. Click <strong>Create policy</strong>. To validate this step, select on the role again and your should see 2 policies attached to your role, including the one you just have created:</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this),$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right'})})"><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Detailed description</span></div><div class=expand-content style=display:none><p><img src=step-8-console.png alt="Step 8"></p></div></div><h4 id=5-add-the-amazon-sqs-queue-as-event-source-for-your-customer-notification-service-aws-lambda-function>5. Add the Amazon SQS queue as event source for your Customer Notification Service AWS Lambda function</h4><p>Open your <strong><a href=https://console.aws.amazon.com/lambda/home?#/functions>AWS Lambda console</a></strong> and select <strong>Functions</strong> in the left navigation. Click on the function with the name <code>%INITIALS%-wild-rydes-async-msg-2-CustomerNotification...</code> (assuming your have chosen <code>%INITIALS%-wild-rydes-async-msg-2</code> as your stack name). Click on the <strong>+ Add Trigger</strong> button on the left side of the page:</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this),$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right'})})"><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Detailed description</span></div><div class=expand-content style=display:none><p><img src=step-9-console.png alt="Step 9"></p></div></div><p>On the following page, select <code>SQS</code> as the event source for this AWS Lambda function. For the <strong>SQS queue</strong>, select the <code>%INITIALS%-CustomerNotificationServiceQueue</code> and set the <strong>batch size</strong> to <code>1</code>. Don&rsquo;t forget to <strong>enable the trigger</strong>, before you click the <strong>Add</strong> button in the lower right corner.</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this),$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right'})})"><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Detailed description</span></div><div class=expand-content style=display:none><p><img src=step-10-console.png alt="Step 10"></p></div></div><p>After some seconds, the trigger will be enabled and and you are ready to go (you may have to refresh the site a few times).</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this),$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right'})})"><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Detailed description</span></div><div class=expand-content style=display:none><p><img src=step-11-console.png alt="Step 11"></p></div></div><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-next" href=../../prerequisites.html title="Workshop Prerequisites" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../../js/clipboard.min.js></script><script src=../../js/perfect-scrollbar.min.js></script><script src=../../js/perfect-scrollbar.jquery.min.js></script><script src=../../js/jquery.sticky.js></script><script src=../../js/featherlight.min.js></script><script src=../../js/html5shiv-printshiv.min.js></script><script src=../../js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad()</script><script src=../../js/modernizr.custom-3.6.0.js></script><script src=../../js/learn.js></script><script src=../../js/hugo-learn.js></script><link href=../../mermaid/mermaid.css rel=stylesheet><script src=../../mermaid/mermaid.js></script><script>mermaid.initialize({startOnLoad:!0})</script></body></html>