<!doctype html><html class=no-js lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta property="og:title" content="Wild Rydes Asynchronous Messaging Workshop"><meta property="og:type" content="website"><meta property="og:url" content><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=generator content="Hugo 0.83.1"><meta name=description content="Wild Rydes Asynchronous Messaging Workshop"><meta name=author content="Jane Architect"><link rel="shortcut icon" href=https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico type=image/ico><link rel=icon href=https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico type=image/ico><title>Topic-Queue Chaining & Load Balancing :: Wild Rydes Asynchronous Messaging Workshop</title><link href=./css/nucleus.css rel=stylesheet><link href=./css/fontawesome-all.min.css rel=stylesheet><link href=./css/hybrid.css rel=stylesheet><link href=./css/featherlight.min.css rel=stylesheet><link href=./css/perfect-scrollbar.min.css rel=stylesheet><link href=./css/auto-complete.css rel=stylesheet><link href=./css/atom-one-dark-reasonable.css rel=stylesheet><link href=./css/theme.css rel=stylesheet><link href=./css/hugo-theme.css rel=stylesheet><link href=./css/theme-aws.css rel=stylesheet><link href=./css/jquery-ui.min.css rel=stylesheet><script src=./js/jquery-3.5.1.min.js></script><script src=./js/jquery-ui-1.12.1.min.js></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style></head><body data-url=./topic-queue-chaining-and-load-balancer.html><nav id=sidebar><div id=header-wrapper><div id=header><div><a href=./ title="Go home"><img style=vertical-align:middle src=./images/logo.png height=70px></a></div></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=./js/lunr.min.js></script><script type=text/javascript src=./js/auto-complete.js></script><script type=text/javascript>var baseurl="https://marcinbelczewski.github.io/asynchronous-messaging-workshop/"</script><script type=text/javascript src=./js/search.js></script></div><div class=highlightable><ul class=topics><li data-nav-id=/prerequisites.html title="Workshop Prerequisites" class=dd-item><a href=./prerequisites.html>Workshop Prerequisites</a><ul><li data-nav-id=/prerequisites/prerequisites-1.html title="Account Setup" class=dd-item><a href=./prerequisites/prerequisites-1.html>Account Setup</a><ul></ul></li><li data-nav-id=/prerequisites/prerequisites-2/prerequisites-2.html title="Configure AWS Cloud9" class=dd-item><a href=./prerequisites/prerequisites-2/prerequisites-2.html>Configure AWS Cloud9</a></li></ul></li><li data-nav-id=/choose-your-own-advanture.html title="Choose Your Own Adventure" class=dd-item><a href=./choose-your-own-advanture.html>Choose Your Own Adventure</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer.html title="Topic-Queue Chaining & Load Balancing" class="dd-item
parent
active"><a href=./topic-queue-chaining-and-load-balancer.html>Lab-2: Topic-Queue Chaining & Load Balancing</a><ul><li data-nav-id=/topic-queue-chaining-and-load-balancer/bootstrap-initial-state/bootstrap-initial-state.html title="Bootstrap the Initial State" class=dd-item><a href=./topic-queue-chaining-and-load-balancer/bootstrap-initial-state/bootstrap-initial-state.html>1 Bootstrap the Initial State</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer/create-sns-topic/create-sns-topic.html title="Create the Amazon SNS topic" class=dd-item><a href=./topic-queue-chaining-and-load-balancer/create-sns-topic/create-sns-topic.html>2 Create the Amazon SNS topic</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer/create-customer-notification-service-subscription/create-customer-notification-service-subscription.html title="Create Customer Notification Service Subscription" class=dd-item><a href=./topic-queue-chaining-and-load-balancer/create-customer-notification-service-subscription/create-customer-notification-service-subscription.html>3 Create Customer Notification Service Subscription</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer/create-customer-accounting-service-subscription/create-customer-accounting-service-subscription.html title="Create Customer Accounting Service Subscription" class=dd-item><a href=./topic-queue-chaining-and-load-balancer/create-customer-accounting-service-subscription/create-customer-accounting-service-subscription.html>4 Create Customer Accounting Service Subscription</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer/create-extraordinary-rides-service-subscription/create-extraordinary-rides-service-subscription.html title="Create Extraordinary Rides Service Subscription" class=dd-item><a href=./topic-queue-chaining-and-load-balancer/create-extraordinary-rides-service-subscription/create-extraordinary-rides-service-subscription.html>5 Create Extraordinary Rides Service Subscription</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer/update-unicorn-management-service/update-unicorn-management-service.html title="Update Unicorn Management Service" class=dd-item><a href=./topic-queue-chaining-and-load-balancer/update-unicorn-management-service/update-unicorn-management-service.html>6 Update Unicorn Management Service</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer/test-topic-queue-chaining-and-load-balancer/test-topic-queue-chaining-and-load-balancing.html title="Test Topic-Queue Chaining & Load Balancing" class=dd-item><a href=./topic-queue-chaining-and-load-balancer/test-topic-queue-chaining-and-load-balancer/test-topic-queue-chaining-and-load-balancing.html>7 Test Topic-Queue Chaining & Load Balancing</a></li><li data-nav-id=/topic-queue-chaining-and-load-balancer/clean-up/clean-up.html title="Clean up" class=dd-item><a href=./topic-queue-chaining-and-load-balancer/clean-up/clean-up.html>8 Clean up</a></li></ul></li><li data-nav-id=/resources.html title=Resources class=dd-item><a href=./resources.html>Resources</a></li></ul><section id=shortcuts><h3></h3><ul><li><a class=padding href=https://github.com/marcinbelczewski/asynchronous-messaging-workshop/><i class="fab fa-github"></i> Github repo</a></li></ul></section><section id=footer><left><h5 class=copyright>&copy; 2019 Amazon Web Services, Inc. or its Affiliates. All rights reserved.<h5></left></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://code.amazon.com/packages/AwsSaDeMsgPtnMcrSrv/trees/mainline/--/workshop/content/topic-queue-chaining-and-load-balancer/_index.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fa fa-bars"></i></a></span>
<span id=toc-menu><i class="fa fa-list-alt"></i></span>
<span class=links><a href=https://marcinbelczewski.github.io/asynchronous-messaging-workshop/>Decoupled Microservices</a> > Topic-Queue Chaining & Load Balancing
          
      </span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#lab-objectives>Lab Objectives</a></li></ul></nav></div></div></div></div><div id=body-inner><h1>Topic-Queue Chaining & Load Balancing</h1><div class="notices info"><p>Make sure you executed the <strong><a href=./prerequisites.html>Workshop Prerequisites</a></strong> first, before you start with this lab!</p></div><p>Letâ€™s look once more at the publish/subscribe channel between the unicorn management service and all 3 backend services on the right hand side that are interested in getting notified about ride completions.</p><p>One of these services could happen to be taken offline for maintenance. Or the code that processes messages coming in from the ride completion topic could run into an exception. These are two examples where a subscriber service could potentially miss topic messages. A good pattern to apply here is <strong>topic-queue-chaining</strong>. That means that you add a queue, in our case an Amazon SQS queue, between the ride completion Amazon SNS topic and each of the subscriber services.<br>As messages are buffered in a persistent manner in an SQS queue, no message will get lost should a subscriber process run into problems for many hours or days, or has exceptions or crashes.</p><p>But there is even more to it. By having an Amazon SQS queue in front of each subscriber service, we can leverage the fact that a queue can act as a <strong>buffering load-balancer</strong>. Due to nature that every queue message is delivered to one of potentially many consumer processes, you can easily scale your subscriber services out & in and the message load will be distributed over the available consumer processes. Furthermore, since messages are buffered in the queue, also a scaling event, for instance when you need to wait until an additional consumer process becomes operational, will not make you lose messages.</p><p>In this lab, we will develop the architecture below:</p><p><img src=topic-queue-chaining-and-load-balancer/module-2.png alt="Module 2"></p><h2 id=lab-objectives>Lab Objectives</h2><p>In this lab, you will acquire the following skills:</p><ul><li><strong>How to create an Amazon SQS queue?</strong></li><li><strong>How to leverage Amazon SQS as event source for AWS Lambda?</strong></li><li><strong>How to add an Amazon SQS subscription to an Amazon SNS topic?</strong></li><li><strong>How to define a subscription filter in an Amazon SNS subscriptions?</strong></li><li><strong>How to call Amazon SNS from AWS Lambda?</strong></li></ul><div class="notices tip"><p><strong>Lab source code</strong><br>If you are curious and would like to dive into the lab&rsquo;s source code, you are more than welcome to do so. You will find the source code of this lab in our Github repo <strong><a href=https://github.com/marcinbelczewski/asynchronous-messaging-workshop/>here</a></strong>.</p></div><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=./choose-your-own-advanture.html title="Choose Your Own Adventure"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=./topic-queue-chaining-and-load-balancer/bootstrap-initial-state/bootstrap-initial-state.html title="Bootstrap the Initial State" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=./js/clipboard.min.js></script><script src=./js/perfect-scrollbar.min.js></script><script src=./js/perfect-scrollbar.jquery.min.js></script><script src=./js/jquery.sticky.js></script><script src=./js/featherlight.min.js></script><script src=./js/html5shiv-printshiv.min.js></script><script src=./js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad()</script><script src=./js/modernizr.custom-3.6.0.js></script><script src=./js/learn.js></script><script src=./js/hugo-learn.js></script><link href=./mermaid/mermaid.css rel=stylesheet><script src=./mermaid/mermaid.js></script><script>mermaid.initialize({startOnLoad:!0})</script></body></html>